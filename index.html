<!DOCTYPE html>
<html lang="id" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal Resmi KONTAN Universitas Terbuka Jakarta 2025-2027</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Poppins:wght@500;700;800&family=Share+Tech+Mono&family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: { primary: '#15432d', secondary: '#f0fdf4', accent: '#fbbf24' },
                    fontFamily: { mono: ['Share Tech Mono', 'monospace'], sans: ['Inter', 'sans-serif'], heading: ['Poppins', 'sans-serif'], script: ['Dancing Script', 'cursive'] },
                    animation: { 
                        'float': 'float 6s ease-in-out infinite', 
                        'wiggle': 'wiggle 2s ease-in-out infinite', 
                        'breath': 'breath 3s ease-in-out infinite', 
                        'slide-up': 'slideUp 0.5s ease-out',
                        'bounce-soft': 'bounceSoft 2s infinite'
                    },
                    keyframes: {
                        float: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-15px)' } },
                        wiggle: { '0%, 100%': { transform: 'rotate(-5deg)' }, '50%': { transform: 'rotate(5deg)' } },
                        breath: { '0%, 100%': { transform: 'scale(1)' }, '50%': { transform: 'scale(1.05)' } },
                        slideUp: { from: { opacity: 0, transform: 'translateY(20px)' }, to: { opacity: 1, transform: 'translateY(0)' } },
                        bounceSoft: { '0%, 100%': { transform: 'translateY(-5%)' }, '50%': { transform: 'translateY(0)' } }
                    }
                }
            }
        }
    </script>
    <style>
        :root { --glass-bg: rgba(255, 255, 255, 0.95); --glass-border: rgba(255, 255, 255, 0.6); }
        .dark { --glass-bg: rgba(15, 23, 42, 0.9); --glass-border: rgba(255, 255, 255, 0.1); }
        body { font-family: 'Inter', sans-serif; background-color: #f0fdf4; transition: background-color 0.3s; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='49' viewBox='0 0 28 49'%3E%3Cg fill-rule='evenodd'%3E%3Cg id='hexagons' fill='%2315432d' fill-opacity='0.05' fill-rule='nonzero'%3E%3Cpath d='M13.99 9.25l13 7.5v15l-13 7.5L1 31.75v-15l12.99-7.5zM3 17.9v12.7l10.99 6.34 11-6.35V17.9l-11-6.34L3 17.9zM0 15l12.98-7.5V0h-2v6.35L0 12.69v2.3zm0 18.5L12.98 41v8h-2v-6.85L0 35.81v-2.3zM15 0v7.5L27.99 15H28v-2.31h-.01L17 6.35V0h-2zm0 49v-8l12.99-7.5H28v2.31h-.01L17 42.15V49h-2z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E"); background-attachment: fixed; color: #1f2937; }
        .dark body { background-color: #0f172a; color: #f1f5f9; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='28' height='49' viewBox='0 0 28 49'%3E%3Cg fill-rule='evenodd'%3E%3Cg id='hexagons' fill='%23ffffff' fill-opacity='0.03' fill-rule='nonzero'%3E%3Cpath d='M13.99 9.25l13 7.5v15l-13 7.5L1 31.75v-15l12.99-7.5zM3 17.9v12.7l10.99 6.34 11-6.35V17.9l-11-6.34L3 17.9zM0 15l12.98-7.5V0h-2v6.35L0 12.69v2.3zm0 18.5L12.98 41v8h-2v-6.85L0 35.81v-2.3zM15 0v7.5L27.99 15H28v-2.31h-.01L17 6.35V0h-2zm0 49v-8l12.99-7.5H28v2.31h-.01L17 42.15V49h-2z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E"); }
        .glass-card { background: var(--glass-bg); backdrop-filter: blur(16px); border: 1px solid var(--glass-border); box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.07); color: inherit; }
        .nav-link.active::after { width: 100%; } .nav-link::after { content: ''; position: absolute; width: 0; height: 3px; bottom: -2px; left: 0; background: #fbbf24; transition: 0.3s; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .section-content { display: none; opacity: 0; animation: slideUp 0.5s forwards; } .section-content.active { display: block; }
        #toast-container { position: fixed; top: 80px; right: 20px; z-index: 9999; pointer-events: none; }
        .toast-card { pointer-events: auto; position: relative; min-width: 300px; background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); border-radius: 16px; padding: 12px 20px 12px 70px; box-shadow: 0 10px 30px -10px rgba(0,0,0,0.2); border: 1px solid rgba(255,255,255,0.5); transform: translateX(120%) perspective(500px) rotateY(-10deg); transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55); display: flex; align-items: center; overflow: visible; color: #1f2937; }
        .dark .toast-card { background: #ffffff !important; color: #000000 !important; border: 2px solid #fbbf24; }
        .toast-card.show { transform: translateX(0) perspective(500px) rotateY(0deg); }
        .toast-mascot { position: absolute; left: -15px; bottom: 5px; width: 70px; height: 70px; font-size: 50px; filter: drop-shadow(0 5px 5px rgba(0,0,0,0.2)); animation: wiggle 3s ease-in-out infinite; z-index: 20; }
        #loader { position: fixed; inset: 0; z-index: 9999; background: #15432d; display: flex; flex-direction: column; justify-content: center; align-items: center; transition: opacity 0.8s; }
        .rating-btn.active { color: #fbbf24; transform: scale(1.2); }
        .music-bars { display: flex; align-items: flex-end; height: 20px; gap: 2px; }
        .bar { width: 3px; background: #fbbf24; animation: sound 0ms -800ms linear infinite alternate; }
        .playing .bar { animation-duration: 400ms; }
        
        .chat-bubble { background: rgba(255,255,255,0.9); padding: 10px 14px; border-radius: 12px; margin-bottom: 8px; font-size: 0.85rem; box-shadow: 0 1px 2px rgba(0,0,0,0.1); max-width: 85%; animation: slideUp 0.3s; color: #333; }
        .chat-bubble.bot { border-bottom-left-radius: 0; margin-right: auto; border: 1px solid #e5e7eb; background: white; }
        .chat-bubble.user { border-bottom-right-radius: 0; margin-left: auto; background: #dcfce7; color: #064e3b; }
        .typing-indicator { display: inline-block; width: 6px; height: 6px; border-radius: 50%; background: #ccc; margin: 0 2px; animation: typing 1s infinite; }
        @keyframes typing { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }
        
        .slider-container { overflow: hidden; position: relative; width: 100%; border-radius: 1.5rem; height: 400px; box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); }
        .slider-wrapper { display: flex; transition: transform 0.7s ease-in-out; height: 100%; }
        .slide { min-width: 100%; position: relative; height: 100%; background-size: cover; background-position: center; }
        .slide-content { position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(to top, rgba(0,0,0,0.8), transparent); padding: 2rem; color: white; }

        .timeline-line { position: absolute; left: 24px; top: 0; bottom: 0; width: 3px; background: #e5e7eb; }
        .dark .timeline-line { background: #374151; }
        
        .tree ul { padding-top: 20px; position: relative; display: flex; justify-content: center; }
        .tree li { float: left; text-align: center; list-style-type: none; position: relative; padding: 20px 5px 0 5px; }
        .tree li::before, .tree li::after { content: ''; position: absolute; top: 0; right: 50%; border-top: 2px solid #ccc; width: 50%; height: 20px; }
        .tree li::after { right: auto; left: 50%; border-left: 2px solid #ccc; }
        .tree li:only-child::after, .tree li:only-child::before { display: none; } .tree li:only-child { padding-top: 0; }
        .tree li:first-child::before, .tree li:last-child::after { border: 0 none; }
        .tree li:last-child::before { border-right: 2px solid #ccc; border-radius: 0 5px 0 0; } .tree li:first-child::after { border-radius: 5px 0 0 0; }
        .tree ul ul::before { content: ''; position: absolute; top: 0; left: 50%; border-left: 2px solid #ccc; width: 0; height: 20px; }
        .org-card { padding: 10px; background: white; border-radius: 12px; border: 1px solid #e2e8f0; box-shadow: 0 2px 4px rgba(0,0,0,0.05); transition: 0.3s; min-width: 120px; position: relative; z-index: 10; color: #333; }
        .org-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); border-color: #fbbf24; z-index: 20; }
        .org-card img { width: 50px; height: 50px; object-fit: cover; border-radius: 50%; margin: 0 auto 5px; border: 2px solid #15432d; }

        .sk-paper { background-color: #fffaf0; background-image: url('https://www.transparenttextures.com/patterns/cream-paper.png'); position: relative; border: 1px solid #d1d5db; }
        .stamp { position: absolute; right: 30px; bottom: 90px; width: 90px; height: 90px; border: 3px double #15432d; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #15432d; font-weight: bold; opacity: 0.7; transform: rotate(-20deg); font-size: 10px; text-align: center; pointer-events: none; mix-blend-mode: multiply; }

        .admin-panel { position: fixed; bottom: 6rem; left: 6rem; width: 300px; background: white; padding: 1.5rem; border-radius: 1rem; box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1); z-index: 49; display: none; }
        .admin-panel.open { display: block; animation: slideUp 0.3s; }
        .editable-active { border: 2px dashed #fbbf24; cursor: text; }
        
        .feedback-item { border-left: 4px solid #fbbf24; background: rgba(255,255,255,0.7); padding: 10px; margin-bottom: 8px; border-radius: 0 8px 8px 0; font-size: 0.9rem; color: #1f2937; }
        .wa-float { position: fixed; bottom: 2rem; right: 2rem; z-index: 50; background-color: #25D366; color: white; padding: 14px; border-radius: 50%; box-shadow: 0 4px 15px rgba(0,0,0,0.3); transition: transform 0.3s; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .wa-float:hover { transform: scale(1.1); }
        .chat-widget { position: fixed; bottom: 90px; right: 20px; z-index: 49; width: 320px; background: white; border-radius: 16px; box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1); transform: scale(0); transform-origin: bottom right; transition: transform 0.3s; overflow: hidden; }
        .dark .chat-widget { background: #1f2937; border: 1px solid #374151; }
        .chat-widget.open { transform: scale(1); }

        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="min-h-screen pb-20 text-gray-800 dark:text-gray-200">

    <audio id="bgAudio" loop><source id="audioSource" src="https://cdn.pixabay.com/download/audio/2022/05/27/audio_1808fbf07a.mp3?filename=lofi-study-112191.mp3" type="audio/mpeg"></audio>

    <div id="loader">
        <img src="assets/img/Logo KONTAN.png" class="w-32 h-32 mb-4 rounded-full bg-white p-2 animate-breath shadow-2xl" onerror="this.src='https://placehold.co/150x150/ffffff/15432d?text=K'">
        <h2 class="text-white font-bold text-2xl tracking-widest text-center">KONTAN UT JAKARTA<br><span class="text-sm normal-case text-green-200 font-normal">Universitas Terbuka Jakarta</span></h2>
        <button onclick="enterSite()" class="mt-8 px-8 py-3 bg-yellow-500 text-green-900 font-bold rounded-full shadow-lg hover:bg-yellow-400 hover:scale-105 transition transform animate-bounce">üîä Masuk Portal</button>
    </div>

    <div id="toast-container"></div>

    <nav class="bg-[#15432d] text-white shadow-lg sticky top-0 z-40 backdrop-blur-md bg-opacity-95 border-b border-white/10">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center gap-2 font-bold text-lg cursor-pointer" onclick="switchTab('home')">
                    <img src="assets/img/Logo KONTAN.png" alt="KONTAN Universitas Terbuka Jakarta logo - circular emblem with green background used in navigation header" class="w-8 h-8 rounded-full bg-white p-0.5" onerror="this.src='https://placehold.co/100x100/15432d/white?text=K'">
                    <span>KONTAN UT Jakarta</span>
                </div>
                <div class="flex items-center gap-4">
                    <div class="hidden md:flex space-x-4 text-sm font-medium">
                        <a onclick="switchTab('home')" class="nav-link active" id="nav-home">Beranda</a>
                        <a onclick="switchTab('student-corner')" class="nav-link" id="nav-student-corner">Student Corner</a>
                        <a onclick="switchTab('announcement')" class="nav-link" id="nav-announcement">Pengumuman</a>
                        <a onclick="switchTab('activities')" class="nav-link" id="nav-activities">Kegiatan</a>
                        <a onclick="switchTab('structure')" class="nav-link" id="nav-structure">Struktur Kepengurusan</a>
                        <a onclick="switchTab('curhat')" class="nav-link text-yellow-300" id="nav-curhat">Curhat</a>
                    </div>
                    <button onclick="toggleMusic()" class="p-2 rounded-full bg-white/10 hover:bg-white/20 transition tooltip-btn relative group"><span id="musicIcon">üéµ</span></button>
                    <button onclick="toggleDarkMode()" class="p-2 rounded-full hover:bg-white/10 transition">üåô</button>
                    <button class="md:hidden text-2xl" onclick="document.getElementById('mobileMenu').classList.toggle('hidden')">‚ò∞</button>
                </div>
            </div>
        </div>
        <div id="mobileMenu" class="hidden md:hidden bg-[#123b27] pb-4 dark:bg-gray-800">
            <a onclick="switchTab('home')" class="block px-4 py-2 hover:bg-white/10">Beranda</a>
            <a onclick="switchTab('student-corner')" class="block px-4 py-2 hover:bg-white/10">Student Corner</a>
            <a onclick="switchTab('announcement')" class="block px-4 py-2 hover:bg-white/10">Pengumuman</a>
            <a onclick="switchTab('activities')" class="block px-4 py-2 hover:bg-white/10">Kegiatan</a>
            <a onclick="switchTab('structure')" class="block px-4 py-2 hover:bg-white/10">Struktur</a>
            <a onclick="switchTab('curhat')" class="block px-4 py-2 text-pink-300">Curhat</a>
            <a onclick="switchTab('reg-member')" class="block px-4 py-2 text-yellow-300">Gabung Anggota</a>
        </div>
    </nav>

    <!-- === BERANDA === -->
    <section id="home" class="section-content active max-w-5xl mx-auto p-6 space-y-12">
        <header class="text-center pt-8 relative">
            <img src="assets/img/Logo KONTAN.png" class="w-32 h-32 mx-auto rounded-full bg-white p-1 shadow-xl relative z-10 animate-float" onerror="this.src='https://placehold.co/200x200/15432d/white?text=Logo'">
            <h1 class="text-4xl md:text-5xl font-extrabold text-[#15432d] dark:text-green-400 mt-4 editable">PORTAL KONTAN</h1>
            <p class="text-lg text-gray-600 dark:text-gray-300 editable">Universitas Terbuka Jakarta</p>
            <div class="mt-8 flex justify-center gap-4">
                <button onclick="switchTab('reg-member')" class="px-6 py-3 bg-[#15432d] text-white rounded-full font-bold shadow-lg hover:bg-green-800 transition">Gabung Anggota</button>
                <button onclick="switchTab('reg-board')" class="px-6 py-3 bg-white text-[#15432d] border-2 border-[#15432d] rounded-full font-bold shadow-lg hover:bg-green-50 transition">Daftar Pengurus</button>
            </div>
        </header>

        <!-- SAMBUTAN KETUA -->
        <div class="glass-card rounded-3xl p-8 md:p-12 relative overflow-hidden dark:bg-gray-800 dark:border-gray-700 border-l-8 border-yellow-400 flex flex-col md:flex-row gap-8 items-center">
            <img src="assets/img/foto ketua.png" class="w-32 h-32 rounded-full shadow-lg object-cover border-4 border-white dark:border-gray-600 transform hover:scale-105 transition">
            <div>
                <h2 class="text-2xl font-bold mb-4 text-[#15432d] dark:text-green-400">Sambutan Ketua Umum</h2>
                <p class="text-gray-700 dark:text-gray-300 text-lg leading-relaxed italic">"Selamat datang di rumah kita bersama. KONTAN hadir sebagai wadah aspirasi, kreasi, dan prestasi. Mari bersinergi membangun masa depan yang lebih cerah dan berintegritas."</p>
                <p class="mt-4 font-bold text-[#15432d] dark:text-green-400 uppercase tracking-wider">‚Äî Deni, Ketua Umum 2025-2027</p>
            </div>
        </div>

        <!-- AI CHAT BOT -->
        <div class="glass-card p-6 rounded-2xl border-t-4 border-blue-500">
            <div class="flex justify-between items-center mb-4 border-b pb-2 border-gray-200">
                <div class="flex items-center gap-2">
                    <div class="w-10 h-10 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center animate-bounce text-xl">ü§ñ</div>
                    <div>
                        <h3 class="font-bold text-gray-800 dark:text-white text-sm">KONTAN AI Assistant</h3>
                        <p class="text-[10px] text-green-600 flex items-center gap-1"><span class="w-1.5 h-1.5 bg-green-500 rounded-full"></span> Online</p>
                    </div>
                </div>
            </div>
            <div id="chatContainer" class="h-48 overflow-y-auto mb-4 custom-scroll bg-white/50 dark:bg-gray-900/50 p-3 rounded-xl border border-gray-100 dark:border-gray-700">
                <div class="chat-bubble bot">Halo!üëã Saya asisten virtual KONTAN. Silakan tanya tentang pendaftaran, acara, atau organisasi.</div>
            </div>
            <div class="flex gap-2">
                <input type="text" id="chatInput" placeholder="Ketik pertanyaanmu..." class="flex-grow p-2.5 border rounded-xl dark:bg-gray-700 dark:text-white text-sm outline-none focus:ring-2 focus:ring-blue-500 transition" onkeypress="if(event.key==='Enter') sendChat()">
                <button onclick="sendChat()" class="p-2.5 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition">üöÄ</button>
            </div>
        </div>

        <!-- FEEDBACK ON HOME -->
        <div class="glass-card rounded-2xl p-8 border-t-4 border-blue-500 mt-8">
             <h3 class="text-xl font-bold text-gray-800 dark:text-white mb-4 flex items-center gap-2">üí¨ Feedback & Rating</h3>
             <div class="flex gap-1 mb-2 justify-center">
                 <button class="rating-btn text-xl text-gray-300 transition" onclick="setRating(1)">‚≠ê</button>
                 <button class="rating-btn text-xl text-gray-300 transition" onclick="setRating(2)">‚≠ê</button>
                 <button class="rating-btn text-xl text-gray-300 transition" onclick="setRating(3)">‚≠ê</button>
                 <button class="rating-btn text-xl text-gray-300 transition" onclick="setRating(4)">‚≠ê</button>
                 <button class="rating-btn text-xl text-gray-300 transition" onclick="setRating(5)">‚≠ê</button>
             </div>
             <div id="homeFeedbacks" class="h-32 overflow-y-auto pr-2 space-y-3 text-sm text-gray-600 dark:text-gray-300 custom-scroll mb-4">
                 <div class="feedback-item">"Sangat informatif! Terima kasih KONTAN." - Maba 2025</div>
             </div>
             <div class="flex gap-2">
                 <input id="feedbackText" type="text" class="flex-grow p-3 border rounded-lg dark:bg-gray-700 dark:text-white text-sm" placeholder="Tulis saran atau pesan...">
                 <button onclick="submitFeedback()" class="px-4 py-2 bg-blue-600 text-white rounded-lg text-sm hover:bg-blue-700">Kirim</button>
             </div>
        </div>

        <!-- COMPACT CONTACT -->
        <div class="text-center py-6 mt-8 border-t border-gray-200 dark:border-gray-700">
             <h4 class="font-bold text-primary dark:text-green-400 mb-3 text-xs uppercase tracking-widest">HUBUNGI KAMI</h4>
             <div class="flex justify-center gap-4 text-xs font-medium text-gray-600 dark:text-gray-300">
                 <a href="https://wa.me/6281273995026" target="_blank" class="hover:text-green-600">üì± 0812-7399-5026</a>
                 <span class="text-gray-300">|</span>
                 <a href="mailto:kontan.utjakarta@gmail.com" class="hover:text-red-600">üìß kontan.utjakarta@gmail.com</a>
                 <span class="text-gray-300">|</span>
                 <a href="https://instagram.com/kontan.utjakarta" target="_blank" class="hover:text-pink-600">üì∏ @kontan.utjakarta</a>
             </div>
        </div>
    </section>

    <!-- === STUDENT CORNER === -->
    <section id="student-corner" class="section-content max-w-6xl mx-auto p-6 space-y-10">
        <h2 class="text-4xl font-bold text-center mb-8 text-gray-800 dark:text-white">üéì Student Corner</h2>
        
        <!-- MUSIC ZONE -->
        <div class="bg-gradient-to-r from-gray-900 to-gray-800 rounded-3xl p-8 text-white shadow-2xl relative overflow-hidden">
            <div class="flex flex-col md:flex-row justify-between items-center mb-6 relative z-10">
                <h3 class="text-2xl font-bold flex items-center gap-2">üéß Zona Musik & Fokus</h3>
                <div class="flex gap-2">
                    <button onclick="changeMusic('lofi')" class="px-3 py-1 bg-purple-600 rounded text-xs">Lo-Fi</button>
                    <button onclick="changeMusic('piano')" class="px-3 py-1 bg-blue-600 rounded text-xs">Piano</button>
                </div>
            </div>
            <div class="bg-black/40 backdrop-blur-md rounded-xl p-4 border border-white/10 mb-4">
                <iframe id="spotifyFrame" style="border-radius:12px" src="https://open.spotify.com/embed/playlist/37i9dQZF1DX8Uebhn9wqrS?utm_source=generator&theme=0" width="100%" height="152" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
            </div>
        </div>

        <!-- QUIZ (5 SOAL RADIO) -->
        <div class="glass-card p-6 rounded-2xl bg-gradient-to-r from-indigo-600 to-purple-600 text-white text-center">
            <h3 class="text-xl font-bold mb-4">üß† Kuis Akuntansi Harian</h3>
            <div id="quizContainer">
                <div class="flex justify-between text-xs mb-2 opacity-80"><span>Soal <span id="qNum">1</span>/5</span><span>Skor: <span id="qScore">0</span></span></div>
                <div class="bg-white/10 p-4 rounded-xl mb-4 min-h-[80px] flex items-center justify-center font-medium text-lg text-center" id="quizQuestion">Loading...</div>
                <div class="grid grid-cols-1 gap-2" id="quizOptions"></div>
            </div>
            <div id="quizResult" class="hidden text-center">
                <h4 class="text-2xl font-bold mb-2">Selesai!</h4>
                <p>Skor Kamu: <span id="finalScore" class="font-bold text-yellow-300"></span>/5</p>
                <button onclick="resetQuiz()" class="mt-4 px-6 py-2 bg-white text-purple-700 font-bold rounded-full">Main Lagi</button>
            </div>
        </div>

        <!-- POMODORO & MAGIC BALL -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="bg-[#15432d] text-white rounded-2xl shadow-xl p-6 text-center relative overflow-hidden dark:bg-gray-800 border dark:border-gray-700">
                <h3 class="text-lg font-bold mb-2">üçÖ Focus Timer</h3>
                <div class="font-mono text-5xl font-bold mb-4 tracking-widest" id="timerDisplay">25:00</div>
                <div class="flex justify-center gap-4">
                    <button onclick="startTimer()" id="startTimerBtn" class="bg-white text-green-900 px-4 py-2 rounded-full font-bold hover:bg-gray-100">Mulai</button>
                    <button onclick="resetTimer()" class="bg-white/20 text-white px-4 py-2 rounded-full font-bold hover:bg-white/30">Reset</button>
                </div>
            </div>
            <div class="bg-indigo-800 text-white rounded-2xl shadow-xl p-6 text-center relative overflow-hidden">
                <h3 class="text-lg font-bold mb-2">üîÆ Bola Ajaib</h3>
                <input type="text" id="magicInput" placeholder="Keraguanmu..." class="w-full p-2 rounded text-black text-center text-sm mb-4">
                <div id="magicBall" class="w-20 h-20 bg-black rounded-full mx-auto flex items-center justify-center border-4 border-indigo-900 shadow-xl cursor-pointer hover:scale-105 transition" onclick="askMagicBall()">
                    <div id="magicAnswer" class="w-8 h-8 bg-blue-950 rounded-full flex items-center justify-center text-[8px] text-center p-1 text-white font-bold">8</div>
                </div>
            </div>
        </div>

        <!-- FAQ & TIMELINE -->
         <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
             <div class="glass-card p-6 rounded-2xl">
                 <h3 class="text-xl font-bold mb-4 dark:text-white">‚ùì FAQ Anggota</h3>
                 <div class="space-y-2 h-40 overflow-y-auto custom-scroll pr-2">
                     <details class="bg-gray-50 dark:bg-gray-700 p-2 rounded cursor-pointer text-sm"><summary class="font-bold">Apa benefit anggota?</summary><p class="mt-1 text-xs text-gray-600 dark:text-gray-300">Relasi, info akademik, pelatihan.</p></details>
                     <details class="bg-gray-50 dark:bg-gray-700 p-2 rounded cursor-pointer text-sm"><summary class="font-bold">Ada iuran kas?</summary><p class="mt-1 text-xs text-gray-600 dark:text-gray-300">Rp 10.000/bulan.</p></details>
                     <details class="bg-gray-50 dark:bg-gray-700 p-2 rounded cursor-pointer text-sm"><summary class="font-bold">Bagaimana cara gabung menjadi anggota KONTAN?</summary><p class="mt-1 text-xs text-gray-600 dark:text-gray-300">Isi formulir di Beranda portal ini, Dan pilih daftar anggota.</p></details>
                        <details class="bg-gray-50 dark:bg-gray-700 p-2 rounded cursor-pointer text-sm"><summary class="font-bold">Kapan biasanya ada acara KONTAN?</summary><p class="mt-1 text-xs text-gray-600 dark:text-gray-300">Setiap bulan ada acara online/offline.</p></details>
                        <details class="bg-gray-50 dark:bg-gray-700 p-2 rounded cursor-pointer text-sm"><summary class="font-bold">Siapa yang bisa dihubungi untuk info lebih lanjut?</summary><p class="mt-1 text-xs text-gray-600 dark:text-gray-300">Silahkan hubungi kami via email atau Humas KONTAN via WhatsApp.</p></details>
                 </div>
             </div>
             <div class="glass-card rounded-2xl p-6 border-l-4 border-yellow-500 dark:border-yellow-600">
                <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">üìÖ Timeline Tuton</h3>
                <div id="tutonTimeline" class="space-y-3 text-sm">
                    <!-- JS will fill this -->
                </div>
            </div>
        </div>
    </section>

    <!-- === PENGUMUMAN SK === -->
    <section id="announcement" class="section-content max-w-4xl mx-auto p-6">
        <div class="glass-card rounded-3xl p-8 text-center">
            <h2 class="text-3xl font-bold mb-6 text-primary dark:text-green-400">Pengumuman Kelulusan</h2>
            <div class="max-w-sm mx-auto space-y-4 mb-8 text-left">
                <div>
                    <label class="text-sm font-bold text-gray-700 dark:text-gray-300">Masukkan NIM:</label>
                    <input type="text" id="checkNIMInput" placeholder="Masukan NIM Anda" class="w-full p-3 border rounded-lg dark:bg-gray-800 dark:text-white mt-1">
                    <p id="emailError" class="hidden text-red-500 text-xs mt-1 font-bold">‚ö†Ô∏è Data tidak ditemukan.</p>
                </div>
                <!-- PASSWORD FIELD IS BACK -->
                <div class="mt-4">
                    <label class="text-sm font-bold text-gray-700 dark:text-gray-300">Sandi Akses:</label>
                    <input type="password" id="checkPassInput" placeholder="Sandi Akses" class="w-full p-3 border rounded-lg dark:bg-gray-800 dark:text-white mt-1">
                </div>

                <!-- CAPTCHA -->
                <div class="bg-gray-100 dark:bg-gray-800 p-3 rounded-lg border dark:border-gray-700 mt-4">
                    <div class="flex items-center justify-between mb-2">
                        <canvas id="captchaCanvas" width="120" height="40" class="bg-white rounded border"></canvas>
                        <button onclick="generateCaptcha()" class="text-xs text-blue-500 underline">Refresh</button>
                    </div>
                    <input type="text" id="captchaInput" placeholder="Ketik kode (Case Sensitive)" class="w-full p-2 text-sm border rounded dark:bg-gray-700 dark:text-white">
                </div>

                <button onclick="checkResult()" id="checkResultBtn" class="w-full py-3 bg-primary text-white font-bold rounded-lg hover:bg-green-800 transition shadow-md mt-4">Cek Hasil</button>
            </div>
            
            <div id="resultArea" class="hidden text-left animate-slide-up">
                <div id="skLetterPreview" class="bg-white text-black p-8 rounded shadow-xl sk-paper border-gray-200">
                    <div class="flex items-center border-b-2 border-black pb-4 mb-4 gap-4">
                        <div class="text-center flex-grow leading-tight">
                            <h3 class="font-bold text-lg font-serif">KOMUNITAS AKUNTANSI (KONTAN)</h3>
                            <h4 class="font-bold text-base font-serif">UNIVERSITAS TERBUKA JAKARTA</h4>
                        </div>
                    </div>
                    <div class="text-center mb-4">
                        <h3 class="font-bold text-lg underline font-serif" id="skTitle">SURAT KEPUTUSAN</h3>
                        <p class="text-sm font-mono">No: 001/A/KONTAN-UT/XII/2025</p>
                    </div>
                    <div class="space-y-4 text-justify text-sm font-serif relative z-10">
                        <p>Berdasarkan hasil seleksi, Panitia menyatakan bahwa:</p>
                        <div class="ml-4 my-4 font-bold">
                            <p>Nama : <span id="resNama">NAMA PESERTA</span></p>
                            <p>NIM : <span id="resNIM">000000000</span></p>
                        </div>
                        <div id="skContentLulus">
                            <p>Dinyatakan <strong class="text-green-700">LULUS</strong> pada posisi:</p>
                            <div class="text-center py-2 border-y border-gray-200 bg-green-50"><h2 class="text-xl font-bold text-primary" id="resDivisi">DIVISI</h2></div>
                            <div class="mt-4 p-4 bg-yellow-50 border-l-4 border-yellow-400 italic text-gray-600">
                                "Selamat atas amanah baru ini. Saya percaya Saudara/i mampu membawa perubahan positif bagi KONTAN. Mari berkarya bersama!" 
                                <br><span class="text-xs font-bold not-italic mt-2 block">- Ketua Umum</span>
                            </div>
                        </div>
                        <div id="skContentGagal" class="hidden">
                            <div class="text-center py-3 bg-red-50 border border-red-200 rounded mb-4">
                                <h2 class="text-xl font-bold text-red-600">TIDAK LOLOS</h2>
                            </div>
                            <p>Mohon maaf, Anda belum memenuhi kriteria seleksi pada periode ini. Terima kasih atas partisipasi dan antusiasme yang telah diberikan.</p>
                            <p class="mt-2 font-bold text-gray-600">Alasan: <span id="rejectReason" class="font-normal text-black"></span></p>
                            <p class="mt-4 italic">"Kegagalan adalah kesempatan untuk memulai lagi dengan lebih cerdas. Tetap semangat!"</p>
                        </div>
                    </div>
                    <div class="mt-8 flex justify-end relative">
                        <div class="stamp" id="stampLulus">KONTAN<br>SAH</div>
                        <div class="text-center w-48 relative z-10">
                            <p class="text-sm">Jakarta, 9 Desember 2025</p>
                            <p class="text-sm font-bold">Ketua Umum,</p>
                            <div class="h-16 flex items-center justify-center"><span class="font-script text-2xl text-blue-900">Deni</span></div>
                            <p class="font-bold underline">Deni</p>
                        </div>
                    </div>
                </div>
                <button onclick="downloadSKPDF()" class="mt-6 w-full py-3 bg-red-600 text-white font-bold rounded-lg hover:bg-red-700 flex items-center justify-center gap-2"><span>üìÑ Unduh SK (PDF)</span></button>
            </div>
        </div>
    </section>

    <!-- === ACTIVITIES (CAROUSEL SLIDER + TIMELINE) === -->
    <section id="activities" class="section-content max-w-6xl mx-auto p-6">
        <h2 class="text-3xl font-bold mb-8 text-center text-gray-800 dark:text-white">Agenda & Kegiatan</h2>
        <div class="slider-container shadow-2xl relative h-[400px] group rounded-2xl overflow-hidden border-4 border-white dark:border-gray-700">
            <div class="slider-wrapper h-full" id="sliderWrapper">
                <div class="slide h-full bg-cover bg-center" style="background-image: url('https://placehold.co/800x500/15432d/white?text=Gathering+Akbar');">
                    <div class="slide-content"><span class="bg-yellow-500 text-black text-xs font-bold px-2 py-1 rounded mb-2 inline-block">UPCOMING</span><h3 class="text-3xl font-bold mb-2">Community Insight Gathering With KONTAN #2025</h3><p>Menyambut keluarga baru & Penggurus baru KONTAN.</p></div>
                </div>
                <div class="slide h-full bg-cover bg-center" style="background-image: url('https://placehold.co/800x500/3b82f6/white?text=Webinar+Perpajakan');">
                    <div class="slide-content"><span class="bg-blue-500 text-white text-xs font-bold px-2 py-1 rounded mb-2 inline-block">WEBINAR</span><h3 class="text-3xl font-bold mb-2">Webinar Perpajakan</h3><p>Bedah tuntas materi Perpajakan With Kak Anastasha.</p></div>
                </div>
            </div>
            <button onclick="moveSlide(-1)" class="absolute left-4 top-1/2 -translate-y-1/2 bg-black/30 text-white p-3 rounded-full hover:bg-black/50 transition z-20">‚ùÆ</button>
            <button onclick="moveSlide(1)" class="absolute right-4 top-1/2 -translate-y-1/2 bg-black/30 text-white p-3 rounded-full hover:bg-black/50 transition z-20">‚ùØ</button>
        </div>
    </section>

    <!-- === STRUCTURE === -->
    <section id="structure" class="section-content max-w-full mx-auto p-6 overflow-x-auto text-center">
        <h2 class="text-3xl font-bold mb-8 text-gray-800 dark:text-white">Struktur Pengurus KONTAN</h2>
        <div class="tree inline-block min-w-[1000px] pb-10">
            <ul>
                <li>
                    <div class="org-card border-t-4 border-yellow-500"><img src="https://placehold.co/60x60/15432d/white?text=K"><div class="role">Ketua Umum</div><div class="name">Deni</div></div>
                    <ul>
                        <li>
                            <div class="org-card border-t-4 border-green-500"><img src="https://placehold.co/60x60/15432d/white?text=W"><div class="role">Wakil Ketua</div><div class="name">Johannaf</div></div>
                            <ul>
                                <li><div class="org-card border-t-4 border-blue-600"><img src="https://placehold.co/50x50/e2e8f0/64748b?text=S"><div class="role">Sekjen</div><div class="name">Dyah Ayu Kusumaningtyas</div></div><ul><li><div class="org-card border-t-2 border-blue-300"><img src="https://placehold.co/40x40/e2e8f0/64748b?text=SU"><div class="role">Sekum</div><div class="name">Nama</div></div></li></ul></li>
                                <li><div class="org-card border-t-4 border-yellow-500"><img src="https://placehold.co/50x50/e2e8f0/64748b?text=B"><div class="role">Bendahara 1</div><div class="name">Anastasha</div></div><ul><li><div class="org-card border-t-2 border-yellow-300"><img src="https://placehold.co/40x40/e2e8f0/64748b?text=B2"><div class="role">Bendum 2</div><div class="name">Nama</div></div></li></ul></li>
                                <li><div class="org-card border-t-4 border-purple-600"><img src="https://placehold.co/50x50/e2e8f0/64748b?text=K"><div class="role">Koord. Divisi</div><div class="name">M. Lutfi</div></div>
                                    <ul>
                                        <li><div class="org-card bg-gray-50"><img src="https://placehold.co/40x40/e2e8f0/64748b?text=Kl"><div class="role">Keilmuan</div><div class="name">Kadiv</div></div></li>
                                        <li><div class="org-card bg-gray-50"><img src="https://placehold.co/40x40/e2e8f0/64748b?text=Sr"><div class="role">Sosro</div><div class="name">Kadiv</div></div></li>
                                        <li><div class="org-card bg-gray-50"><img src="https://placehold.co/40x40/e2e8f0/64748b?text=Mb"><div class="role">Minat Bakat</div><div class="name">Kadiv</div></div></li>
                                        <li><div class="org-card bg-gray-50"><img src="https://placehold.co/40x40/e2e8f0/64748b?text=Hm"><div class="role">Humas</div><div class="name">Kadiv</div></div></li>
                                        <li><div class="org-card bg-gray-50"><img src="https://placehold.co/40x40/e2e8f0/64748b?text=Md"><div class="role">Meditekraf</div><div class="name">Kadiv</div></div></li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
    </section>

    <!-- === CURHAT & SUARA MAHASISWA === -->
    <section id="curhat" class="section-content max-w-4xl mx-auto p-6 text-center">
        <div class="p-10 rounded-3xl shadow-2xl relative overflow-hidden" style="background: linear-gradient(135deg, #ff00cc, #333399); color: white;">
            <h2 class="text-4xl font-bold mb-4">üíå Curhat Mahasiswa</h2>
            <textarea id="curhatInput" rows="3" class="w-full bg-white/20 text-white placeholder-white/70 p-4 rounded-xl outline-none text-center font-bold" placeholder="Ketik pesanmu di sini..."></textarea>
            <button onclick="sendCurhat()" class="mt-4 px-8 py-2 bg-black text-white font-bold rounded-full hover:scale-105 transition">Kirim üöÄ</button>
        </div>
        <div class="mt-10 text-left glass-card rounded-2xl p-8 border-t-4 border-blue-500">
             <h3 class="text-2xl font-bold text-gray-700 dark:text-gray-300 mb-4 text-center">Suara Mahasiswa (Live Chat)</h3>
             <div id="curhatWall" class="h-64 overflow-y-auto custom-scroll space-y-4 pr-2"></div>
        </div>
    </section>

    <!-- === REGISTRATION (UPDATED FORM) === -->
    <section id="reg-member" class="section-content max-w-2xl mx-auto p-6">
        <div class="glass-card p-8 rounded-2xl text-center border-t-4 border-theme">
            <h2 class="text-3xl font-bold mb-6 text-theme dark:text-green-400">Formulir Anggota Baru</h2>
            <div class="space-y-4 text-left">
                <input type="text" id="regNama" placeholder="Nama Lengkap" class="w-full p-3 border rounded-lg dark:bg-gray-700 dark:text-white">
                <input type="email" id="regEmail" placeholder="Email" class="w-full p-3 border rounded-lg dark:bg-gray-700 dark:text-white">
                <div class="grid grid-cols-2 gap-4">
                    <input type="number" id="regSemester" placeholder="Semester" class="w-full p-3 border rounded-lg dark:bg-gray-700 dark:text-white">
                    <input type="text" id="regDomisili" placeholder="Domisili" class="w-full p-3 border rounded-lg dark:bg-gray-700 dark:text-white">
                </div>
                
                <div class="p-4 border rounded-lg bg-gray-50 dark:bg-gray-800">
                    <p class="font-bold text-sm mb-2 text-gray-600 dark:text-gray-300">Pilih Program Studi (FE):</p>
                    <div class="grid grid-cols-2 gap-2 text-sm text-gray-700 dark:text-gray-300">
                        <label class="flex items-center space-x-2"><input type="checkbox" name="prodi" value="Akuntansi"><span>Akuntansi</span></label>
                        <label class="flex items-center space-x-2"><input type="checkbox" name="prodi" value="Manajemen"><span>Manajemen</span></label>
                        <label class="flex items-center space-x-2"><input type="checkbox" name="prodi" value="Manajemen Bisnis"><span>Manajemen Bisnis</span></label>
                        <label class="flex items-center space-x-2"><input type="checkbox" name="prodi" value="Pariwisata"><span>Pariwisata</span></label>
                        <label class="flex items-center space-x-2"><input type="checkbox" name="prodi" value="Akuntansi Keuangan Publik"><span>Akuntansi Keuangan Publik</span></label>
                        <label class="flex items-center space-x-2"><input type="checkbox" name="prodi" value="Ekonomi Syariah"><span>Ekonomi Syariah</span></label>
                    </div>
                </div>
                
                <button onclick="submitToWA()" class="w-full py-4 bg-green-600 text-white font-bold rounded-xl hover:bg-green-700 transition shadow-lg flex items-center justify-center gap-2"><span>Lanjut ke WhatsApp</span></button>
            </div>
        </div>
    </section>
    
    <section id="reg-board" class="section-content max-w-2xl mx-auto p-6">
        <div class="glass-card p-8 rounded-2xl text-center border-t-4 border-yellow-500">
            <h2 class="text-2xl font-bold mb-4 text-theme dark:text-green-400">Recruitment Pengurus</h2>
            <div class="space-y-4">
                <input type="text" id="boardNama" placeholder="Nama Lengkap" class="w-full p-3 border rounded dark:bg-gray-700 dark:text-white">
                <select id="boardDivisi" class="w-full p-3 border rounded dark:bg-gray-700 dark:text-white"><option value="">Pilih Divisi</option><option>Hubungan Masyarakat</option><option>media, Teknologi, & Kreatif</option><option>Minat Dan Bakat</option><option>Sosial Dan Kerohanian</option><option>Keilmuan</option>/select>
                <button onclick="submitToWABoard()" class="w-full py-3 bg-yellow-500 text-white font-bold rounded">Kirim Lamaran</button>
            </div>aceholder="Email" class="w-full p-3 border rounded-lg dark:bg-gray-700 dark:text-white">
                <div class="grid grid-cols-2 gap-4">
                    <input type="number" id="regSemester" placeholder="Semester" class="w-full p-3 border rounded-lg dark:bg-gray-700 dark:text-white">
                    <input type="text" id="regDomisili" placeholder="Domisili" class="w-full p-3 border rounded-lg dark:bg-gray-700 dark:text-white">
        </div>
    </section>

    <!-- FLOATING WA -->
    <a href="https://wa.me/6281273995026" target="_blank" class="fixed bottom-8 right-8 z-50 bg-green-500 text-white w-14 h-14 rounded-full flex items-center justify-center shadow-lg hover:scale-110 transition animate-bounce">
        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.297-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372-.272.297-1.04 1.017-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.626.712.226 1.36.194 1.872.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z"/></svg>
    </a>

    <!-- ADMIN PANEL -->
    <button id="toggleAdminBtn" class="fixed bottom-20 left-6 z-40 bg-gray-900 text-white p-4 rounded-full shadow-2xl hover:bg-gray-700 transition">‚öôÔ∏è</button>
    <div id="adminPanel" class="admin-panel hidden" style="left: 6rem; bottom: 6rem;">
        <h3 class="font-bold mb-4 text-gray-800">Panel Admin</h3>
        <button id="editToggle" onclick="toggleEditMode()" class="w-full bg-gray-200 p-2 rounded text-sm mb-2">Mode Edit: OFF</button>
        <button onclick="saveState()" class="w-full bg-blue-600 text-white p-2 rounded text-sm">Simpan</button>
        <input type="file" id="logoInput" accept="image/*" class="hidden">
    </div>

    <script>
        const STORAGE_KEY = "kontan_portal_final_v5_fixed";
        let state = { isEditMode: false, content: {}, logoSrc: null, curhats: [] };
        let isMusicPlaying = false;
        let pomodoroTime = 1500;
        let timerInterval;
        let currentSlide = 0;
        let currentQ = 0;
        let quizScore = 0;
        let captchaCode = "";
        let userRating = 0; 
        
        // --- DATABASE SISWA ---
        const studentDB = [
            { nim: "54741674", nama: "Aditya Pratama", div: "Hubungan Masyarakat", status: "Diterima" },
            { nim: "49386363", nama: "Anggita Cahyaningrum", div: "Sekertaris Umum", status: "Diterima" },
            { nim: "52712979", nama: "Arip Januar", div: "Sosial & Kerohanian", status: "Diterima" },
            { nim: "53210132", nama: "Ayu Sri Wahyuli", div: "Media, Teknologi, & Kreatif", status: "Diterima" },
            { nim: "55399531", nama: "Ayumi Fitri Maryam", div: "Minat & Bakat", status: "Diterima" },
            { nim: "51551461", nama: "Fatimatu Zahra", div: "Minat & Bakat", status: "Diterima" },
            { nim: "54564663", nama: "Fitri Mutisari", div: "Sosial & Kerohanian", status: "Diterima" },
            { nim: "51084842", nama: "Haliza Putri Krisnaeni", div: "Bendahara", status: "Diterima" },
            { nim: "55848041", nama: "Harry Salim", div: "-", status: "Tidak Diterima", reason: "UPBJJ berasal dari Bogor, Dan bukan dari FEB melainkan FHISIP" },
            { nim: "55747306", nama: "Hendra Permana Kusumah", div: "Keilmuan", status: "Diterima" },
            { nim: "55973105", nama: "Ike Setiawati", div: "Hubungan Masyarakat", status: "Diterima" },
            { nim: "53832313", nama: "Marissa Vivaliani", div: "Sosial & Kerohanian", status: "Diterima" },
            { nim: "55747431", nama: "Naila Athifah", div: "Media, Teknologi, & Kreatif", status: "Diterima" },
            { nim: "53260936", nama: "Putri Zulfah Syamsyyah", div: "Minat & Bakat", status: "Diterima" },
            { nim: "52707218", nama: "Rasyid Athallah Hakim", div: "Hubungan Masyarakat", status: "Diterima" },
            { nim: "54589847", nama: "Shafira Nurlita", div: "Hubungan Masyarakat", status: "Diterima" },
            { nim: "56180077", nama: "Shany Dina Kusmayanti", div: "Minat & Bakat", status: "Diterima" },
            { nim: "053260936", nama: "Sinta Shelawati", div: "Sosial & Kerohanian", status: "Diterima" },
            { nim: "55746028", nama: "Veronika Manurung", div: "Keilmuan", status: "Diterima", reason: "" },
            { nim: "56450886", nama: "Zulfa Amalia", div: "Error", status: "Tidak Diterima", reason: "Tidak hadir wawancara" },
            { nim: "053834363", nama: "Syifa Fauziah", div: "Sosial & Kerohanian", status: "Diterima", reason: "selamat Anda Terpilih Menjadi Bagian Dari Keluarga KONTAN" }
       
        ];

        // QUIZ DATA
        const quizData = [
            { q: "Apa persamaan dasar akuntansi?", opts: ["A. Harta = Utang + Modal", "B. Modal = Harta + Utang", "C. Utang = Harta + Modal", "D. Harta = Beban"], a: 0 },
            { q: "Saldo normal akun 'Pendapatan' adalah?", opts: ["A. Debit", "B. Kredit", "C. Nol", "D. Saldo Awal"], a: 1 },
            { q: "Laporan yang menunjukkan posisi keuangan?", opts: ["A. Laba Rugi", "B. Perubahan Modal", "C. Neraca", "D. Arus Kas"], a: 2 },
            { q: "Jurnal penutup dibuat pada?", opts: ["A. Awal Periode", "B. Tengah Periode", "C. Akhir Periode", "D. Saat Transaksi"], a: 2 },
            { q: "Akun riil meliputi?", opts: ["A. Harta, Utang, Modal", "B. Pendapatan, Beban", "C. Harta, Beban", "D. Utang, Pendapatan"], a: 0 }
        ];

        let musicTracks = [
            { title: "Lofi Chill", src: "https://cdn.pixabay.com/download/audio/2022/05/27/audio_1808fbf07a.mp3?filename=lofi-study-112191.mp3" },
            { title: "Piano Moment", src: "https://cdn.pixabay.com/download/audio/2022/03/10/audio_c8c8a73467.mp3?filename=piano-moment-111438.mp3" }
        ];
        let currentTrackIdx = 0;

        const playlist = {
            lofi: "https://cdn.pixabay.com/download/audio/2022/05/27/audio_1808fbf07a.mp3?filename=lofi-study-112191.mp3",
            piano: "https://cdn.pixabay.com/download/audio/2022/03/10/audio_c8c8a73467.mp3?filename=piano-moment-111438.mp3",
            nature: "https://cdn.pixabay.com/download/audio/2021/08/09/audio_03e06c3036.mp3?filename=forest-lullaby-110624.mp3"
        };
        
        // TIMELINE DATA
        const timelineData = [
             { week: "MINGGU 1", title: "Aktivasi Tuton", desc: "Wajib klik kesediaan di elearning" },
             { week: "MINGGU 3", title: "Tugas 1", desc: "Kerjakan Tugas Wajib 1" },
             { week: "MINGGU 5", title: "Tugas 2", desc: "Kerjakan Tugas Wajib 2" },
             { week: "MINGGU 7", title: "Tugas 3", desc: "Kerjakan Tugas Wajib 3" },
             { week: "MINGGU 8", title: "UAS", desc: "Persiapan Ujian Akhir Semester" }
        ];

        window.onload = () => {
            setTimeout(() => { document.getElementById('loader').style.opacity = '0'; setTimeout(() => document.getElementById('loader').style.display = 'none', 800); }, 1500);
            setInterval(autoSlide, 5000); 
            
            // Safe binding for checkResultBtn
            const checkBtn = document.getElementById('checkResultBtn');
            if (checkBtn) { checkBtn.onclick = checkResult; }

            loadState(); renderCurhats(); renderQuiz(); renderTimeline(); generateCaptcha();
        };

        // --- CORE FUNCTIONS ---
        function switchTab(tabId) {
            document.querySelectorAll('.section-content').forEach(el => el.classList.remove('active'));
            const section = document.getElementById(tabId);
            if (section) section.classList.add('active');
            
            document.querySelectorAll('.nav-link').forEach(el => el.classList.remove('active'));
            const navLink = document.getElementById('nav-'+tabId);
            if (navLink) navLink.classList.add('active');
            window.scrollTo(0,0);
        }

        function toggleDarkMode() { document.documentElement.classList.toggle('dark'); }
        function showToast(msg, type='success') {
            const t = document.createElement('div'); t.className = `toast-card ${type=='error'?'border-red-500':'border-green-500'}`;
            t.innerHTML = `<div class="toast-mascot">üòº</div><div><div class="font-bold">${type=='success'?'Info':'Alert'}</div><div class="text-sm">${msg}</div></div>`;
            document.getElementById('toast-container').appendChild(t);
            setTimeout(()=>t.classList.add('show'),10); setTimeout(()=>{t.classList.remove('show');setTimeout(()=>t.remove(),500)},3000);
        }

        // --- MUSIC ---
        function toggleMusic() {
            const audio = document.getElementById('bgAudio');
            if(audio.paused) { audio.src = musicTracks[currentTrackIdx].src; audio.play().catch(()=>{}); showToast("Play: " + musicTracks[currentTrackIdx].title); }
            else { audio.pause(); showToast("Paused"); }
        }
        function changeMusic(type) {
             const audio = document.getElementById('bgAudio');
             const source = document.getElementById('audioSource');
             source.src = playlist[type]; audio.load();
             var playPromise = audio.play();
             if (playPromise !== undefined) { playPromise.then(_ => {}).catch(error => {}); }
             showToast("Ganti Lagu: " + type, "success");
        }
        
        function addToCalendar(title, desc, dateStr) {
            const url = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(title)}&details=${encodeURIComponent(desc)}`;
            window.open(url, '_blank');
        }

        // --- AI ---
        function sendChat() {
            const input = document.getElementById('chatInput');
            const msg = input.value.trim();
            if(!msg) return;
            const container = document.getElementById('chatContainer');
            container.innerHTML += `<div class="chat-bubble user">${msg}</div>`;
            input.value = '';
            setTimeout(() => {
                let reply = "Halo! Saya AI KONTAN. Ada yang bisa saya bantu?";
                if(msg.toLowerCase().includes('daftar')) reply = "Untuk mendaftar, buka menu 'Gabung Anggota' atau 'Daftar Pengurus'.";
                if(msg.toLowerCase().includes('lulus')) reply = "Cek menu 'Pengumuman' untuk hasil seleksi.";
                container.innerHTML += `<div class="chat-bubble bot">${reply}</div>`;
                container.scrollTop = container.scrollHeight;
            }, 1000);
        }

        // --- CAPTCHA ---
        function generateCaptcha() {
            const canvas = document.getElementById('captchaCanvas');
            if(!canvas) return;
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = "#f0fdf4"; ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            const chars = "ABCDEFGHJKLMNPQRSTUVWXYZabcdefghjkmnpqrstuvwxyz23456789";
            let code = "";
            for (let i = 0; i < 5; i++) code += chars[Math.floor(Math.random() * chars.length)];
            captchaCode = code;
            
            ctx.font = "bold 24px monospace"; ctx.fillStyle = "#15432d"; ctx.textBaseline = "middle"; ctx.textAlign = "center";
            let x = 20;
            for (let i = 0; i < code.length; i++) {
                ctx.save(); ctx.translate(x, 20); ctx.rotate((Math.random() - 0.5) * 0.4); ctx.fillText(code[i], 0, 0); ctx.restore(); x += 20;
            }
            for(let i=0; i<5; i++) { ctx.strokeStyle = "rgba(0,0,0,0.1)"; ctx.beginPath(); ctx.moveTo(Math.random()*120, Math.random()*40); ctx.lineTo(Math.random()*120, Math.random()*40); ctx.stroke(); }
        }
        
        function togglePasswordVisibility() {
            const passInput = document.getElementById('checkPassInput');
            passInput.type = passInput.type === "password" ? "text" : "password";
        }

        // --- QUIZ ---
        function renderQuiz() {
            const container = document.getElementById('quizOptions');
            const q = quizData[currentQ];
            const qNum = document.getElementById('qNum');
            const qQ = document.getElementById('quizQuestion');
            
            // Check if elements exist
            if (qNum) qNum.innerText = currentQ + 1;
            if (qQ) qQ.innerText = q.q;
            
            if (container) {
                container.innerHTML = q.opts.map((opt, i) => 
                    `<label class="flex items-center space-x-3 p-3 rounded-lg border border-white/20 hover:bg-white/10 cursor-pointer transition">
                        <input type="radio" name="quiz" class="accent-yellow-400 w-5 h-5" onclick="checkAnswer(${i})">
                        <span>${opt}</span>
                    </label>`
                ).join('');
            }
        }
        function checkAnswer(idx) {
            if(idx === quizData[currentQ].a) {
                quizScore++;
                const sEl = document.getElementById('qScore');
                if(sEl) sEl.innerText = quizScore;
                confetti();
            }
            currentQ = (currentQ + 1) % quizData.length;
            if(currentQ === 0) { alert(`Kuis Selesai! Skor: ${quizScore}/5`); quizScore=0; const sEl = document.getElementById('qScore'); if(sEl) sEl.innerText = 0; }
            setTimeout(renderQuiz, 500);
        }
        function resetQuiz() { currentQ=0; quizScore=0; renderQuiz(); document.getElementById('quizResult').classList.add('hidden'); document.getElementById('quizContainer').classList.remove('hidden'); }

        // --- TIMELINE ---
        function renderTimeline() {
             const container = document.getElementById('tutonTimeline');
             if(container) {
                 container.innerHTML = timelineData.map(t => 
                    `<div class="flex gap-4">
                        <div class="flex-none w-16 text-xs text-gray-500 font-mono pt-1">${t.week}</div>
                        <div class="border-l-2 border-green-500 pl-4 pb-4">
                            <h4 class="font-bold text-sm dark:text-gray-200">${t.title}</h4>
                            <p class="text-xs text-gray-500">${t.desc} 
                                <button onclick="addToCalendar('${t.title}', '${t.desc}', '')" class="ml-2 text-blue-500 underline">Ingatkan</button>
                            </p>
                        </div>
                    </div>`
                 ).join('');
             }
        }

        // --- SK ---
        function checkResult() {
            const nimInput = document.getElementById('checkNIMInput').value.trim();
            const passInput = document.getElementById('checkPassInput').value.trim();
            const captInput = document.getElementById('captchaInput').value.trim(); 
            
            const resultArea = document.getElementById('resultArea');
            const errorBox = document.getElementById('emailError'); 
            const successContent = document.getElementById('skContentLulus');
            const rejectContent = document.getElementById('skContentGagal');
            const titleSurat = document.getElementById('skTitle');
            const stampSurat = document.getElementById('stampLulus');
            
            resultArea.classList.add('hidden');
            if(errorBox) errorBox.classList.add('hidden');
            if(successContent) successContent.classList.add('hidden');
            if(rejectContent) rejectContent.classList.add('hidden');

            if(!nimInput) return showToast("Masukkan NIM!", "error");
            
            // STRICT CAPTCHA CHECK
            if(captInput !== captchaCode) { 
                showToast("Kode Captcha Salah!", "error"); 
                generateCaptcha(); // REFRESH HERE
                document.getElementById('captchaInput').value = '';
                return; 
            }
            
            if(passInput !== 'KONTAN2025') { showToast("Sandi Akses Salah!", "error"); return; }

            // 1. Cek Data Spesifik (Deni)
            if(nimInput === '050111796') {
                document.getElementById('resNama').innerText = "DENI AFENDI";
                document.getElementById('resNIM').innerText = "050111796";
                document.getElementById('resDivisi').innerText = "KETUA UMUM";
                titleSurat.innerText = "SURAT KEPUTUSAN";
                stampSurat.innerHTML = "KONTAN<br>SAH";
                stampSurat.style.display = 'flex';
                if(document.getElementById('ucapanKetua')) document.getElementById('ucapanKetua').classList.remove('hidden');
                if(successContent) successContent.classList.remove('hidden');
                resultArea.classList.remove('hidden');
                confetti();
                return;
            }

            // 2. Cek Data Peserta Lain (Looping Array)
            const foundStudent = studentDB.find(s => s.nim === nimInput);
            
            if (foundStudent) {
                document.getElementById('resNama').innerText = foundStudent.nama.toUpperCase();
                document.getElementById('resNIM').innerText = foundStudent.nim;
                
                resultArea.classList.remove('hidden');

                if(foundStudent.status === "Diterima") {
                     document.getElementById('resDivisi').innerText = foundStudent.div.toUpperCase();
                     titleSurat.innerText = "SURAT KEPUTUSAN";
                     stampSurat.innerHTML = "KONTAN<br>SAH";
                     stampSurat.style.display = 'flex';
                     if(document.getElementById('ucapanKetua')) document.getElementById('ucapanKetua').classList.remove('hidden');
                     if(successContent) successContent.classList.remove('hidden');
                     confetti();
                } else {
                     document.getElementById('resDivisi').innerText = "-"; 
                     titleSurat.innerText = "SURAT PEMBERITAHUAN"; 
                     stampSurat.style.display = 'none'; 
                     if(rejectContent) rejectContent.classList.remove('hidden');
                     
                     const reasonSpan = document.getElementById('rejectReason');
                     if(reasonSpan) reasonSpan.innerText = foundStudent.reason || "Kriteria Belum Terpenuhi";
                }

            } else {
                 if(errorBox) errorBox.classList.remove('hidden');
                 showToast("Data tidak ditemukan", "error");
            }
        }
        async function downloadSKPDF() { const { jsPDF } = window.jspdf; const doc = new jsPDF(); doc.text("SURAT KEPUTUSAN KONTAN",20,20); doc.save("SK_KONTAN.pdf"); }

        // --- REGISTRATION ---
        function submitToWA() {
            const nama = document.getElementById('regNama').value;
            const email = document.getElementById('regEmail').value;
            const smt = document.getElementById('regSemester').value;
            const dom = document.getElementById('regDomisili').value;
            const prodis = Array.from(document.querySelectorAll('input[name="prodi"]:checked')).map(el => el.value).join(', ');
            
            if(!nama || !prodis) return showToast("Lengkapi Nama & Prodi!", "error");
            
            const text = `Halo Admin KONTAN,%0A%0ASaya ingin mendaftar:%0ANama: ${nama}%0AEmail: ${email}%0ASemester: ${smt}%0ADomisili: ${dom}%0AProdi: ${prodis}`;
            window.open(`https://wa.me/6281273995026?text=${text}`, '_blank');
        }

        function submitToWABoard() {
             const nama = document.getElementById('boardNama').value;
             if(!nama) return alert("Isi Nama!");
             window.open(`https://wa.me/6281273995026?text=Halo Admin, saya ${nama} daftar pengurus.`, '_blank');
        }

        // --- EXTRAS ---
        function sendCurhat() {
            const msg = document.getElementById('curhatInput').value;
            if(!msg) return;
            if(!state.curhats) state.curhats = [];
            state.curhats.unshift({ text: msg, date: new Date().toLocaleDateString() });
            saveState(); renderCurhats();
            document.getElementById('curhatInput').value = '';
            showToast("Curhat Terkirim!");
        }
        function renderCurhats() {
            const container = document.getElementById('curhatWall');
            if(container && state.curhats) container.innerHTML = state.curhats.map(c => `<div class="chat-bubble">"${c.text}" <div class="chat-meta">Anonim ‚Ä¢ ${c.date}</div></div>`).join('');
        }
        
        function enterSite() { document.getElementById('loader').style.opacity='0'; setTimeout(()=>document.getElementById('loader').style.display='none',800); toggleMusic(); }
        
        function moveSlide(dir) {
            const slides = document.querySelectorAll('.slide');
            currentSlide = (currentSlide + dir + slides.length) % slides.length;
            document.getElementById('sliderWrapper').style.transform = `translateX(-${currentSlide * 100}%)`;
        }
        function autoSlide() { moveSlide(1); }
        
        function askMagicBall() {
            const ball = document.getElementById('magicBall'); const ans = document.getElementById('magicAnswer');
            ball.classList.add('shake'); ans.innerText = "...";
            setTimeout(() => { ball.classList.remove('shake'); ans.innerText = ["Ya","Tidak","Mungkin"][Math.floor(Math.random()*3)]; }, 500);
        }
        
        function startTimer() { 
             if(isTimerRunning) return; isTimerRunning = true;
             timerInterval = setInterval(() => { pomodoroTime--; document.getElementById('timerDisplay').innerText = pomodoroTime; if(pomodoroTime<=0) clearInterval(timerInterval); }, 1000);
        }
        function resetTimer() { clearInterval(timerInterval); isTimerRunning = false; pomodoroTime = 1500; document.getElementById('timerDisplay').innerText = "25:00"; }
        
        // --- ADDED MISSING FUNCTIONS FOR FEEDBACK AND RATING ---
        function setRating(n) { 
            userRating = n; 
            document.querySelectorAll('.rating-btn').forEach((b, i) => {
                if (i < n) b.classList.add('active', 'text-yellow-400');
                else b.classList.remove('active', 'text-yellow-400');
            });
        }
        
        function submitFeedback() {
            const text = document.getElementById('feedbackText').value;
            if(!userRating && !text) return showToast("Berikan rating atau saran!", "error");
            
            if(text) {
                const container = document.getElementById('homeFeedbacks');
                if(container) {
                    const div = document.createElement('div');
                    div.className = "feedback-item";
                    div.innerText = `"${text}" - Mahasiswa`;
                    container.prepend(div);
                }
            }
            
            showToast("Terima kasih atas masukan Anda!", "success"); 
            document.getElementById('feedbackText').value = ''; 
            setRating(0); 
        }

        function toggleChat() {
            const chat = document.getElementById('chatWidget');
            if(chat) chat.classList.toggle('open');
        }
        
        function saveState() { localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); }
        function loadState() { const s = JSON.parse(localStorage.getItem(STORAGE_KEY)); if(s) { state = s; if(s.curhats) state.curhats = s.curhats; } }
        document.getElementById('logoInput').onchange = (e) => { const r = new FileReader(); r.onload = ev => { document.getElementById('navLogoImg').src = ev.target.result; document.getElementById('customLogo').src = ev.target.result; state.logoSrc = ev.target.result; }; r.readAsDataURL(e.target.files[0]); }
    </script>
</body>
</html>